function t(t){const e=Matter.Engine.create({enableSleeping:!0,positionIterations:6,velocityIterations:4,constraintIterations:6}),n=Matter.Runner.create(),r=function(t,e){const n=Matter.Render.create({element:e,engine:t,options:{width:e.clientWidth,height:e.clientHeight,pixelRatio:1,background:"transparent",hasBounds:!1,wireframes:!1,showSleeping:!1}});return n}(e,t),o=function(t,e){const n=Matter.Mouse.create(e.canvas);e.mouse=n;const r=Matter.MouseConstraint.create(t,{mouse:n,constraint:{stiffness:.2,damping:0,length:0,render:{visible:!1,lineWidth:2,strokeStyle:"#00ff00"}}});return r}(e,r),i=function(t){const e=t.clientWidth,n=t.clientHeight;function r(t,e,n,r){return[{x:t/2-r,y:-n/2,w:t+2*r,h:n},{x:t/2-r,y:e+n/2,w:t+2*r,h:n},{x:-n/2,y:e/2-r,w:n,h:e+2*r},{x:t+n/2,y:e/2-r,w:n,h:e+2*r}]}const o=r(e,n,2e3,0).map((t=>Matter.Bodies.rectangle(t.x,t.y,t.w,t.h,{isStatic:!0,render:{visible:!1}})));return Matter.Composite.add(Matter.Composite.create(),o)}(t);return{engine:e,runner:n,render:r,mouseConstraint:o,walls:i}}function e(t){Matter.Composite.add(t.engine.world,t.walls),Matter.Runner.run(t.runner,t.engine),Matter.Render.run(t.render)}function n(t){Matter.Render.stop(t.render),Matter.Runner.stop(t.runner),Matter.Composite.clear(t.engine.world,!1),Matter.Engine.clear(t.engine)}function r(t,e,n,r){const o=function(t,e,n,r){return{pointerdown:function(){r.isHolding=!0,Matter.Composite.add(t,e)},pointerup:function(){r.isHolding=!1,Matter.Composite.remove(t,e)},pointerleave:function(){r.isHolding=!1,e.constraint.bodyA=null,e.constraint.bodyB=null,e.mouse.position={x:-1,y:-1},Matter.Composite.remove(t,e)},pointermove:function(r){const o=n.getBoundingClientRect();(r.clientX<o.left||r.clientX>o.right||r.clientY<o.top||r.clientY>o.bottom)&&Matter.Composite.remove(t,e)}}}(t,e,n,r);return Object.entries(o).forEach((([t,e])=>{n.addEventListener(t,e)})),()=>{Object.entries(o).forEach((([t,e])=>{n.removeEventListener(t,e)}))}}async function o(t){const e=await async function(t){return new Promise(((e,n)=>{const r=new Image;r.crossOrigin="Anonymous",r.src=t,r.onload=()=>e(r),r.onerror=t=>n(t)}))}(t),n=function(t){const{width:e,height:n}=t,r=document.createElement("canvas");r.width=e,r.height=n;const o=r.getContext("2d");if(!o)throw new Error("Canvas context could not be obtained");o.drawImage(t,0,0,e,n);return o.getImageData(0,0,e,n).data}(e),r=function(t,e,n){const r=[],o=new Set;function i(n,r){return 0===t[4*(r*e+n)+3]}function a(t,e){const n=`${t},${e}`;o.has(n)||(r.push({x:t,y:e}),o.add(n))}for(let s=0;s<n;s++)for(let t=0;t<e;t++)i(t,s)||((0===s||i(t,s-1))&&a(t,s),(s===n-1||i(t,s+1))&&a(t,s),(0===t||i(t-1,s))&&a(t,s),(t===e-1||i(t+1,s))&&a(t,s));return r}(n,e.width,e.height),o=function(t){const e=t.reduce(((t,e)=>(t.x+=e.x,t.y+=e.y,t)),{x:0,y:0});e.x/=t.length,e.y/=t.length;const n=t.map((t=>{const n=Math.atan2(t.y-e.y,t.x-e.x);return{...t,angle:n}}));return n.sort(((t,e)=>t.angle-e.angle)),n.map((t=>({x:t.x,y:t.y})))}(r);return o}async function i(t,e,n){const r=await o(t);let i=1,a=r;if(e){const t=Matter.Bounds.create(r),n=t.max.x-t.min.x,o=t.max.y-t.min.y;i=e/Math.max(n,o);a=function(t,e){const n=t.reduce(((t,e)=>t+e.x),0)/t.length,r=t.reduce(((t,e)=>t+e.y),0)/t.length;return t.map((t=>({x:n+(t.x-n)*e,y:r+(t.y-r)*e})))}(r,.9*i)}return Matter.Bodies.fromVertices(n.x,n.y,[a],{restitution:.2,friction:.1,render:{sprite:{texture:t,xScale:i,yScale:i}}})}export{r as a,i as b,n as c,t as i,e as r};
