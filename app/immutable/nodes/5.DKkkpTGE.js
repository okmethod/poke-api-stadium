import{a as F,e as f,b as V,c as p,d as w,x as T,h as A,f as h,j as g,l as L,m as u,u as O,z as X,o as N,I as Y,J as U,B as q}from"../chunks/scheduler.CjbLQ75Z.js";import{S as z,i as J,b as G,d as K,m as Q,a as Z,t as tt,e as et}from"../chunks/index.C8jGW1p8.js";import{I as nt}from"../chunks/Icon.D9OMTyLg.js";import{g as j}from"../chunks/numerics.BpAOxbdF.js";function rt(){return Matter.Engine.create({enableSleeping:!0,positionIterations:6,velocityIterations:4,constraintIterations:6})}function st(){return Matter.Runner.create()}function at(a,t){return Matter.Render.create({element:t,engine:a,options:{width:t.clientWidth,height:t.clientHeight,pixelRatio:1,background:"transparent",hasBounds:!1,wireframes:!1,showSleeping:!1}})}function ot(a,t){const o=Matter.Mouse.create(t.canvas);return t.mouse=o,Matter.MouseConstraint.create(a,{mouse:o,constraint:{stiffness:.2,damping:0,length:0,render:{visible:!1,lineWidth:2,strokeStyle:"#00ff00"}}})}async function it(a){const t=a.clientWidth,o=a.clientHeight;function e(n,c,r,s){return[{x:n/2-s,y:-r/2,w:n+s*2,h:r},{x:n/2-s,y:c+r/2,w:n+s*2,h:r},{x:-r/2,y:c/2-s,w:r,h:c+s*2},{x:n+r/2,y:c/2-s,w:r,h:c+s*2}]}return e(t,o,2e3,0).map(n=>Matter.Bodies.rectangle(n.x,n.y,n.w,n.h,{isStatic:!0,render:{visible:!1}}))}function ct(a,t,o,e){function i(){e.isHolding=!0,Matter.World.add(a,t)}function n(){e.isHolding=!1,Matter.World.remove(a,t)}function c(){e.isHolding=!1,t.constraint.bodyA=null,t.constraint.bodyB=null,t.mouse.position={x:-1,y:-1},Matter.World.remove(a,t)}function r(s){const l=o.getBoundingClientRect();(s.clientX<l.left||s.clientX>l.right||s.clientY<l.top||s.clientY>l.bottom)&&Matter.World.remove(a,t)}return{pointerdown:i,pointerup:n,pointerleave:c,pointermove:r}}async function lt(a,t){const o=await dt(a),e=ut(o),i=mt(e,o.width,o.height),n=ft(i);return pt(n,t)}async function dt(a){return new Promise((t,o)=>{const e=new Image;e.crossOrigin="Anonymous",e.src=a,e.onload=()=>t(e),e.onerror=i=>o(i)})}function ut(a){const{width:t,height:o}=a,e=document.createElement("canvas");e.width=t,e.height=o;const i=e.getContext("2d");if(!i)throw new Error("Canvas context could not be obtained");return i.drawImage(a,0,0,t,o),i.getImageData(0,0,t,o).data}function mt(a,t,o){const e=[],i=new Set;function n(r,s){const l=(s*t+r)*4;return a[l+3]===0}function c(r,s){const l=`${r},${s}`;i.has(l)||(e.push({x:r,y:s}),i.add(l))}for(let r=0;r<o;r++)for(let s=0;s<t;s++)n(s,r)||((r===0||n(s,r-1))&&c(s,r),(r===o-1||n(s,r+1))&&c(s,r),(s===0||n(s-1,r))&&c(s,r),(s===t-1||n(s+1,r))&&c(s,r));return e}function ft(a){const t=a.reduce((e,i)=>(e.x+=i.x,e.y+=i.y,e),{x:0,y:0});t.x/=a.length,t.y/=a.length;const o=a.map(e=>{const i=Math.atan2(e.y-t.y,e.x-t.x);return{...e,angle:i}});return o.sort((e,i)=>e.angle-i.angle),o.map(e=>({x:e.x,y:e.y}))}function pt(a,t){const o=a.reduce((i,n)=>i+n.x,0)/a.length,e=a.reduce((i,n)=>i+n.y,0)/a.length;return a.map(i=>({x:o+(i.x-o)*t,y:e+(i.y-e)*t}))}async function gt(a,t,o){const e=await lt(a,t*.9);return Matter.Bodies.fromVertices(o.x,o.y,[e],{restitution:.2,friction:.1,density:.001,render:{sprite:{texture:a,xScale:t,yScale:t}}})}function ht(a){let t,o,e='<h1 class="cTitleStyle">ポケモンとりほうだい</h1>',i,n,c,r,s,l="ポケモン ゲットだぜ！",M,b,d,m,y,P,x,I,S,D,R;return y=new nt({props:{icon:"mdi:pokeball",class:"cIconStyle"}}),{c(){t=f("div"),o=f("div"),o.innerHTML=e,i=V(),n=f("div"),c=f("div"),r=f("div"),s=f("span"),s.textContent=l,M=V(),b=f("form"),d=f("button"),m=f("div"),G(y.$$.fragment),P=V(),x=f("div"),I=f("div"),this.h()},l(v){t=p(v,"DIV",{class:!0});var _=w(t);o=p(_,"DIV",{class:!0,"data-svelte-h":!0}),T(o)!=="svelte-jgc82w"&&(o.innerHTML=e),i=A(_),n=p(_,"DIV",{class:!0});var E=w(n);c=p(E,"DIV",{class:!0});var W=w(c);r=p(W,"DIV",{class:!0});var k=w(r);s=p(k,"SPAN",{class:!0,"data-svelte-h":!0}),T(s)!=="svelte-2lras7"&&(s.textContent=l),M=A(k),b=p(k,"FORM",{});var $=w(b);d=p($,"BUTTON",{type:!0,class:!0});var B=w(d);m=p(B,"DIV",{class:!0});var H=w(m);K(y.$$.fragment,H),H.forEach(h),B.forEach(h),$.forEach(h),k.forEach(h),W.forEach(h),P=A(E),x=p(E,"DIV",{class:!0});var C=w(x);I=p(C,"DIV",{class:!0}),w(I).forEach(h),C.forEach(h),E.forEach(h),_.forEach(h),this.h()},h(){g(o,"class","cTitlePartStyle"),g(s,"class","text-lg"),g(m,"class","cIconDivStyle"),g(d,"type","submit"),g(d,"class","cIconButtonStyle"),g(r,"class","cInputFormAndMessagePartStyle"),g(c,"class","flex items-center justify-center"),g(I,"class","w-80 h-80 bg-gray-300 border border-black"),g(x,"class","m-4"),g(n,"class","cContentPartStyle"),g(t,"class","cRouteBodyStyle")},m(v,_){L(v,t,_),u(t,o),u(t,i),u(t,n),u(n,c),u(c,r),u(r,s),u(r,M),u(r,b),u(b,d),u(d,m),Q(y,m,null),u(n,P),u(n,x),u(x,I),a[2](I),S=!0,D||(R=O(b,"submit",X(a[1])),D=!0)},p:N,i(v){S||(Z(y.$$.fragment,v),S=!0)},o(v){tt(y.$$.fragment,v),S=!1},d(v){v&&h(t),et(y),a[2](null),D=!1,R()}}}let yt=!1;function vt(a,t,o){const e=["https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/1.png","https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/4.png","https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/7.png","https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/25.png","https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/133.png"];let i,n,c,r,s;Y(async()=>{n=rt(),c=st(),r=at(n,i),s=ot(n,r);const d=await it(i);{Matter.World.add(n.world,d),Matter.Runner.run(c,n),Matter.Render.run(r);let m=ct(n.world,s,i,{isHolding:yt});if(!m)return;Object.entries(m).forEach(([y,P])=>{i.addEventListener(y,P)})}}),U(()=>{{Matter.Render.stop(r),Matter.Runner.stop(c),Matter.World.clear(n.world,!1),Matter.Engine.clear(n);return}});let l;async function M(){l=j(e.length);const d=j(100),m=await gt(e[l],1,{x:50+d*2,y:20});Matter.World.add(n.world,[m])}function b(d){q[d?"unshift":"push"](()=>{i=d,o(0,i)})}return[i,M,b]}class _t extends z{constructor(t){super(),J(this,t,vt,ht,F,{})}}export{_t as component};
